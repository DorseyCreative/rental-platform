"use strict";(()=>{var e={};e.id=4638,e.ids=[4638],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},5709:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>b,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>h});var n={};r.r(n),r.d(n,{POST:()=>u});var a=r(95419),o=r(69108),s=r(99678),i=r(78070),l=r(68462);function c(e){let t={heavy_equipment:{primary:"#FF6600",secondary:"#003366"},party_rental:{primary:"#E91E63",secondary:"#673AB7"},car_rental:{primary:"#2196F3",secondary:"#FF9800"},tool_rental:{primary:"#4CAF50",secondary:"#FF5722"},custom:{primary:"#3B82F6",secondary:"#10B981"}};return t[e]||t.custom}async function u(e){try{let t;let{websiteUrl:n,logoUrl:a}=await e.json();if(!n)return i.Z.json({success:!1,error:"Website URL is required"},{status:400});console.log("Analyzing website:",n);let o=new URL(n).hostname.toLowerCase(),s="";try{let e=await fetch(n,{headers:{"User-Agent":"Mozilla/5.0 (compatible; BusinessAnalyzer/1.0)"}});if(e.ok){let t=await e.text();s=function(e){let t=e.replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"");t=t.replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"");let r=e.match(/<title[^>]*>(.*?)<\/title>/i),n=e.match(/<h1[^>]*>(.*?)<\/h1>/gi)||[],a=e.match(/<h2[^>]*>(.*?)<\/h2>/gi)||[],o=e.match(/<meta[^>]*name="description"[^>]*content="([^"]*)"[^>]*>/i),s="";return r&&(s+=`TITLE: ${r[1].replace(/<[^>]*>/g,"")} `),o&&(s+=`DESCRIPTION: ${o[1]} `),n.forEach(e=>{s+=`HEADING: ${e.replace(/<[^>]*>/g,"")} `}),a.slice(0,5).forEach(e=>{s+=`SUBHEADING: ${e.replace(/<[^>]*>/g,"")} `}),t=(t=t.replace(/<[^>]*>/g," ")).replace(/\s+/g," ").trim(),(s+" CONTENT: "+t).substring(0,5e3)}(t),console.log("Scraped content length:",s.length)}}catch(e){console.log("Scraping failed:",e instanceof Error?e.message:"Unknown error")}let u=(0,l.Wf)();if(s&&u)try{let e=`You are analyzing the website ${n} for a business intelligence system. Extract REAL, ACCURATE information only.

Website Content: ${s}

CRITICAL REQUIREMENTS:
1. Extract the ACTUAL business name from the website
2. Determine business type based on CONTENT ANALYSIS, not assumptions
3. Find REAL contact information (email, phone, address)
4. Extract ACTUAL brand colors from the website's CSS/styling
5. Identify the company's actual services/products
6. Write a description based on their actual about page or content
7. Look for equipment types, rental categories, service areas

For business type, analyze the content for these keywords:
- Heavy equipment: excavator, bulldozer, crane, backhoe, skid steer, construction equipment
- Party rental: tent, table, chair, wedding, event, party supplies
- Tool rental: drill, saw, hammer, power tools, hand tools
- Car rental: vehicle, car, truck, auto, transportation

Return ONLY valid JSON:
{
  "name": "EXACT business name from website header/title",
  "type": "heavy_equipment|party_rental|car_rental|tool_rental|custom",
  "industry": "Specific industry based on actual content",
  "email": "REAL email found on contact page or footer",
  "phone": "REAL phone number from contact info", 
  "address": "REAL address from contact/location page",
  "description": "2-3 sentence description based on their actual about/services content",
  "features": ["List 5-6 ACTUAL services/features mentioned on their website"],
  "branding": {
    "primaryColor": "Extract dominant color from website design",
    "secondaryColor": "Extract accent color from website design",
    "logoUrl": "Direct URL to their logo image if found"
  },
  "confidence": "Rate 1-100 based on content quality and information found",
  "businessDetails": {
    "servicesOffered": ["List specific services they mention"],
    "serviceAreas": ["Geographic areas they serve if mentioned"],
    "yearEstablished": "Year founded if mentioned",
    "specialties": ["Any specializations or unique offerings"]
  }
}`,r=await u.beta.messages.create({model:"claude-3-5-sonnet-20241022",max_tokens:1500,messages:[{role:"user",content:e}]}),o=r.content[0]?.type==="text"?r.content[0].text:"";console.log("AI Response:",o.substring(0,200));let i=o.match(/\{[\s\S]*\}/);i&&(t=JSON.parse(i[0]),a&&(t.branding.logoUrl=a),console.log("âœ… AI Analysis successful:",t.name))}catch(e){console.log("AI analysis failed:",e instanceof Error?e.message:"Unknown error")}t||(t=function(e,t){let r=t.replace(/^www\./,"").replace(/\.(com|net|org|biz|info)$/,"").split(".").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),n=e.match(/[\w\.-]+@[\w\.-]+\.\w+/g),a=e.match(/\(?\d{3}\)?[-.\s]?\d{3}[-.\s]?\d{4}/g),o="custom";return e.toLowerCase().includes("excavator")||e.toLowerCase().includes("bulldozer")||e.toLowerCase().includes("crane")?o="heavy_equipment":e.toLowerCase().includes("party")||e.toLowerCase().includes("wedding")||e.toLowerCase().includes("tent")?o="party_rental":e.toLowerCase().includes("car")||e.toLowerCase().includes("vehicle")||e.toLowerCase().includes("truck")?o="car_rental":(e.toLowerCase().includes("tool")||e.toLowerCase().includes("drill")||e.toLowerCase().includes("saw"))&&(o="tool_rental"),{name:r,type:o,industry:function(e){let t={heavy_equipment:"Construction Equipment Rental",party_rental:"Event & Party Services",car_rental:"Vehicle Rental Services",tool_rental:"Tool & Equipment Rental",custom:"Rental Services"};return t[e]||t.custom}(o),email:n?n[0]:`contact@${t}`,phone:a?a[0]:"+1-555-000-0000",address:"Address available on website",description:`Professional ${o.replace("_"," ")} services`,features:function(e){let t={heavy_equipment:["GPS Equipment Tracking","Maintenance Scheduling","Delivery Services","Operator Training","Safety Management"],party_rental:["Event Planning","Setup Services","Delivery & Pickup","Inventory Management","Customer Portal"],car_rental:["GPS Vehicle Tracking","Insurance Management","Mileage Monitoring","Digital Contracts","Mobile Check-in"],tool_rental:["Tool Reservations","Safety Management","Maintenance Tracking","Quick Checkout","Inventory Control"],custom:["Inventory Management","Customer Portal","Booking System","Payment Processing"]};return t[e]||t.custom}(o),branding:{primaryColor:c(o).primary,secondaryColor:c(o).secondary},confidence:e.length>500?85:70,customFields:function(e){let t={heavy_equipment:[{name:"Make",type:"text",required:!0},{name:"Model",type:"text",required:!0},{name:"Year",type:"number",required:!0},{name:"Engine Hours",type:"number",required:!0},{name:"Operating Weight",type:"number",required:!1}],party_rental:[{name:"Color",type:"select",required:!0,options:["White","Black","Gold","Silver"]},{name:"Size/Capacity",type:"text",required:!0},{name:"Setup Required",type:"boolean",required:!0}],car_rental:[{name:"Make",type:"text",required:!0},{name:"Model",type:"text",required:!0},{name:"Year",type:"number",required:!0},{name:"Mileage",type:"number",required:!0},{name:"License Plate",type:"text",required:!0}],tool_rental:[{name:"Brand",type:"text",required:!0},{name:"Model",type:"text",required:!0},{name:"Power Type",type:"select",required:!0,options:["Electric","Battery","Gas","Manual"]}],custom:[{name:"Item Name",type:"text",required:!0},{name:"Category",type:"text",required:!0},{name:"Daily Rate",type:"number",required:!0}]};return t[e]||t.custom}(o)}}(s||"",o),a&&(t.branding.logoUrl=a),console.log("\uD83D\uDCCB Using content analysis:",t.name)),console.log("\uD83C\uDF10 Starting web intelligence analysis...");let d=null;try{let e=new AbortController,r=setTimeout(()=>e.abort(),1e4),a=await fetch("http://localhost:3002/api/web-intelligence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessName:t.name,website:n,phone:t.phone,address:t.address,businessType:t.type}),signal:e.signal});if(clearTimeout(r),a.ok){let e=await a.json();e.success&&(d=e.data,console.log("âœ… Web intelligence complete - Reputation Score:",d.reputationScore))}}catch(e){console.log("âš ï¸ Web intelligence timed out or failed, using basic analysis"),d={reputationScore:75+Math.floor(20*Math.random()),googleReviews:{rating:null,reviewCount:null},socialMedia:{facebook:{},linkedin:{},instagram:{}},onlinePresence:{industryListings:[],newsArticles:[]},competitorAnalysis:{marketPosition:"challenger",strengthsVsCompetitors:[],improvementAreas:[]},recommendations:[],overallSentiment:"neutral",lastUpdated:new Date().toISOString()}}let p={...t,webIntelligence:d,website:n};try{let{storeBusiness:e}=await Promise.all([r.e(1068),r.e(3336)]).then(r.bind(r,86176)),t=await e(p);p.id=t,console.log(`ðŸ’¾ Business stored in cloud database with ID: ${t}`)}catch(e){console.error("Failed to store business:",e),p.id=`biz_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}return i.Z.json({success:!0,data:p})}catch(e){return console.error("Analysis error:",e),i.Z.json({success:!1,error:"Analysis failed",data:{name:"Analysis Unavailable",type:"custom",industry:"Rental Services",email:"contact@business.com",phone:"+1-555-000-0000",address:"Address not available",description:"Rental business services",features:["Inventory Management","Customer Portal","Booking System"],branding:{primaryColor:"#3B82F6",secondaryColor:"#10B981"},confidence:50,customFields:[{name:"Item",type:"text",required:!0}]}})}}let d=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/analyze-business/route",pathname:"/api/analyze-business",filename:"route",bundlePath:"app/api/analyze-business/route"},resolvedPagePath:"/Users/macdaddy/heavy-equipment-rental/rental-platform/src/app/api/analyze-business/route.ts",nextConfigOutput:"export",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:y,headerHooks:g,staticGenerationBailout:h}=d,b="/api/analyze-business/route";function f(){return(0,s.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},68462:(e,t,r)=>{r.d(t,{Wf:()=>o});var n=r(12590);let a=null;function o(){if(!process.env.ANTHROPIC_API_KEY)return console.warn("ANTHROPIC_API_KEY not configured - AI features will be disabled"),null;if(!a)try{a=new n.ZP({apiKey:process.env.ANTHROPIC_API_KEY})}catch(e){return console.error("Failed to initialize Anthropic client:",e),null}return a}o()}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[1638,6206,3122,2590],()=>r(5709));module.exports=n})();